<!DOCTYPE html>
<!--
Portable Secret generated with https://mprimi.github.io/portable-secret/

This file is self-contained, it embeds an encrypted payload and will use the browser's
cryptograpy APIs to decode it, if you know the password.
-->
<html>
<head>
  <meta charset="UTF-8" />
  <style>
  body {
    background-color: floralwhite;
    font-size: large;
  }

  div {
    margin: 5px;
  }

  p.plaintext {
    background-color: lavender;
    border: 2px dotted black;
    padding: 3px;
  }

  pre.hint {
    background-color: lavender;
    border: 2px dashed black;
    padding: 3px;
  }
  </style>
  <script>
{{DECRYPT_SCRIPT}}
  </script>
</head>
<!--
The rest of this is just the HTML fields displayed on the page.
The only active element are:
- Encryption inputs (IV, Salt, Cipher) displayed on-load
- Decrypt button
-->
<body onload="loadOpaqueValues()">
  <h1>Portable Secret</h1>

  <p>This file is self-contained.
    It has no dependencies and runs entirely within the browser window.
    It makes no external calls and does not require an internet connection to decrypt.
  </p>
  <p>
    Don't take my word for it. The code is straightforward and commented, and should only take a minute to grok.
  </p>

  <div>
    <h4>Password hint:</h4>
    <pre class="hint">{{PASSWORD_HINT}}</pre>
  </div>

  <div>
    <h4>Password:</h4>
    <input type="text" id="password" placeholder="See hint above" required>
  </div>

  <br>

  <div>
    <input type="button" value="Decrypt" onclick='decrypt()'>
    <span id="errormsg"></span>
  </div>

  <div id="text_output_div" hidden>
    <p id="target_text" class="plaintext"></p>
  </div>

  <div id="image_output_div" hidden>
    <img id="target_image">
  </div>

  <div id="file_output_div" hidden>
    <a id="target_file">Download</a>
  </div>

  <details>
    <summary>Show opaque inputs</summary>

    These are decryption inputs that can be safely transmitted in the clear.
    Without the correct password they are useless.

    <div>
      Salt:
      <input type="text" id="salt" value="" required>
    </div>

    <div>
      IV:
      <input type="text" id="iv" value="" required>
    </div>

    <div>
      Ciphertext:<br>
      <textarea rows="8" cols="80" id="cipher"></textarea>
    </div>
  </details>
</body>
<script>
{{VALUES}}
</script>
</html>
